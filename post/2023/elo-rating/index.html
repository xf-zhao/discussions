<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Elo Rating, Logistic Distribution, and Logistic Regression | Xufeng Zhao / 赵绪锋</title> <meta name="author" content="Xufeng Zhao / 赵绪锋"> <meta name="description" content="A probabilistic explanation of Elo rating approach"> <meta name="keywords" content="Robotics, LLMs, Reinforcement Learning"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/squirtle_circle_transparent.png"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://xf-zhao.github.io/post/2023/elo-rating/"> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><img src="/assets/img/squirtle_circle_transparent.png" width="auto" height="35"> <span class="font-weight-bold">Xufeng </span>Zhao / 赵绪锋</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Posts</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/code/">Code</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/contact/">Contact</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Elo Rating, Logistic Distribution, and Logistic Regression</h1> <p class="post-meta">November 5, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/rating"> <i class="fas fa-hashtag fa-sm"></i> rating</a>   <a href="/blog/tag/probability"> <i class="fas fa-hashtag fa-sm"></i> probability</a>   <a href="/blog/tag/large-language-models"> <i class="fas fa-hashtag fa-sm"></i> large language models</a>     ·   <a href="/blog/category/work"> <i class="fas fa-tag fa-sm"></i> work</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p><strong>Long story short, this post tries to explain Elo rating with a probabilistic perspective, especially the relation with a logistic distribution that many of the existing blogs failed to do.</strong></p> <p>I am currently reading papers about large language models alignment tuning <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>, e.g. reinforcement learning from human feedback (RLHF) used for ChatGPT. One of many kinds of human feedback is “ranking-based approach” <sup id="fnref:1:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>, and then I ran into a related paper by DeepMind that uses Elo rating for the feedback <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup>. Elo rating was initially created for assessing chess palyers’ skill but later widely applied for online games such as League of Legends ranking <sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>.</p> <p>There already exist many webpages, including <a href="https://en.wikipedia.org/wiki/Elo_rating_system" rel="external nofollow noopener" target="_blank">this Elo rating Wikipedia page</a>, that try to explain Elo rating with mathematical formulas. But, as far as I can go, they fail to explain clearly to beginners, for example, who is logistically distributed, and how to derive the final logistic regression.</p> <h2 id="elo-rating">Elo Rating</h2> <p>The core idea of Elo rating system is to “learn” a score, according to their previous comptetion performance, to reveal each player’s skill ability. As a result, the win/loss probability of any two players can be well predicted by comparing the score differnce <sup id="fnref:6" role="doc-noteref"><a href="#fn:6" class="footnote" rel="footnote">4</a></sup> <sup id="fnref:7" role="doc-noteref"><a href="#fn:7" class="footnote" rel="footnote">5</a></sup>. For a win/loss games (i.e. no draw), supposing players A, B are assigned with score \(R_A\) and \(R_B\) respectively, the probability of player A to win is calculated by Elo rating as</p> \[\text{Pr}(\text{A wins}) = \frac{1}{1+10^{-r_{AB}/400}},\] <p>where \(r_{AB} = R_A - R_B\) is the score difference between player A and B. Apprently, this equation is in a logistic function <sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">6</a></sup>. And \(R_A\) and \(R_B\) can be updated with optimization methods, e.g. SGD, accordingly <sup id="fnref:3:1" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>. This updating procedure ends up with formula</p> \[R_A \leftarrow R_A + K [S_A - \text{Pr}(\text{A wins})],\] <p>where \(S_A\) indicates whether player A wins (1) or not (0) (and also similar for the update of player B).</p> <p>In machine learning, a <em>softmax function</em> links non-bounded values with probability: \(p_i = \frac{e^{x_i}}{\sum e^{x_i}}\). A special case when there are only two variables \(p_a = \frac{e^a}{e^a + e^b} = \frac{1}{1 + e^{b-a}}\), which can be usually denoted using <em>sigmoid function</em> \(\sigma(t) = \frac{1}{1+e^{-t}}\) (in this case let \(t = a-b\), in which only the difference between \(a\) and \(b\) matters).</p> <p>Note that the this process is a litter different from machine learning with a batch size because the competetions are streaming data to process, i.e. update parameters <em>with given sample order</em>. If we have directly optimize on the whole data instead of streaming update, the question can be now described as: <em>“How to map the win/loss frequency (or probability) of two players with their skill score difference?”</em> This reduces the degree of freedom of variable to 1 (the difference instead of absolute value of two scores), leading to the fitting problem of \(p = \frac{1}{1+e^{-t/s}}\), where \(p\) is the probability of, for example, “A wins” and \(s\) is a scaling factor. Solving this equation leads to \(t = s \ln \frac{p}{1-p}\). In Elo rating system, \(s = 400\), and the base is chosen as \(10\) instead of \(e\) for human-friendly interpretation. Take a small example of the formula: supposing that player A is 400 score less than player B, the log-odds <sup id="fnref:5" role="doc-noteref"><a href="#fn:5" class="footnote" rel="footnote">7</a></sup> \(\log \frac{p}{1-p} = -1\), and then we get \(p = \frac{1}{11}\) (or the odd \(\frac{p}{1-p} = 1:10\)). Intuitively, a -400 rating difference means that player A only has a chance of \(\frac{1}{11}\) to win (learned according to statistics).</p> <h2 id="logistic-distribution-behind-elo-rating">Logistic Distribution behind Elo Rating</h2> <p>So far the calculation of Elo rating scores and the link to probability meaning is introduced. The assumption is that player performance difference can be modeled vis logistic regression. A higher rating score generally means a better player. But because of the randomness in competetions, it happens that a “generally better player” loses. There are claims <sup id="fnref:3:2" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup> <sup id="fnref:6:1" role="doc-noteref"><a href="#fn:6" class="footnote" rel="footnote">4</a></sup> <sup id="fnref:9" role="doc-noteref"><a href="#fn:9" class="footnote" rel="footnote">8</a></sup> pointing out that player’s <em>performance</em> is rather logistically distributed instead of normally. This question confused me a lot:</p> <p><strong>“What exactly is logistically distributed such that the Elo rating’s logistic regression form can be derived?”</strong></p> <p>Let me start by quoting a <a href="https://www.cantorsparadise.com/the-mathematics-of-elo-ratings-b6bfc9ca1dba" rel="external nofollow noopener" target="_blank">this blog</a> <sup id="fnref:6:2" role="doc-noteref"><a href="#fn:6" class="footnote" rel="footnote">4</a></sup>,</p> <blockquote> <p>the system assumed that players’ expected scores conform to a normal distribution. Later, both the USCF and FIDE altered their systems when it was found their empirics suggested that performance in chess more resembles a logistic distribution (heavier tails/higher probability of extreme outcomes).</p> </blockquote> <h3 id="1-player-absolute-performance">1. Player Absolute Performance</h3> <p>It seems that the intuitive purpose of changing model is to describe (better model fitting) how often a <em>“black swan event”</em> — a low-score player beats a high-score player — happens. However, recall that the pdf of logistic distribution <sup id="fnref:10" role="doc-noteref"><a href="#fn:10" class="footnote" rel="footnote">9</a></sup> is defined as</p> \[f(t) = \frac{u}{s (1+u)^2}, u = e^{-(t-\mu)/s}.\] <p>Its cdf is in a logistic function form: \(F(t) = \frac{1}{1+e^{-(t-\mu)/s}}\).</p> <p>The actually performance of player A and B is defined as random variable \(\alpha_A\) and \(\alpha_B\) respectively.</p> <p>\begin{align} \label{eq:awins} \text{Pr}(\text{A wins}) = \text{Pr}(\alpha_A &gt; \alpha_B) = \int_{-\infty}^{+\infty} \text{Pr}(\alpha_A = a) \cdot \text{Pr}(\alpha_B&lt;a) da = \int_{-\infty}^{+\infty} f(a) da \int_{-\infty}^{a} f(b) db. \end{align}</p> <p>In Eq.\eqref{eq:awins}, \(f(\cdot)\) is the pdf of the players’ performance. This equation relates to compute the pdf of a new random variable \(\alpha_C = \alpha_A - \alpha_B\). If both \(\alpha_A\) and \(\alpha_B\) conform normal distritribution, the resultant rv \(\alpha_C\) will also follow a normal distribution <sup id="fnref:11" role="doc-noteref"><a href="#fn:11" class="footnote" rel="footnote">10</a></sup>. However, this is not the case for logistic distribution <sup id="fnref:12" role="doc-noteref"><a href="#fn:12" class="footnote" rel="footnote">11</a></sup> <sup id="fnref:13" role="doc-noteref"><a href="#fn:13" class="footnote" rel="footnote">12</a></sup>. So the answer to the question is <strong>NOT</strong> exactly the player’s perfomance, i.e. \(\alpha\). But according to the close curve look of the norm and logistic distribution, we can assume that “the sum is approximately logistic” <sup id="fnref:7:1" role="doc-noteref"><a href="#fn:7" class="footnote" rel="footnote">5</a></sup> <sup id="fnref:12:1" role="doc-noteref"><a href="#fn:12" class="footnote" rel="footnote">11</a></sup>. By this approximation, we can roughly say that it is the player’s performance that conforms logistic distribution.</p> <h3 id="2-logistically-distributed-variable">2. Logistically Distributed Variable</h3> <p>If we go precise, the answer should be</p> <blockquote> <p>Elo assumes errors are distributed according to a logistic distribution <sup id="fnref:14" role="doc-noteref"><a href="#fn:14" class="footnote" rel="footnote">13</a></sup></p> </blockquote> <p>or more accurately</p> <blockquote> <p>the difference in the random components of performance is logistically distributed <sup id="fnref:9:1" role="doc-noteref"><a href="#fn:9" class="footnote" rel="footnote">8</a></sup></p> </blockquote> <p>as is straightfoward from the equations. Nevertheless, the <em>difference in randomness</em> is no longer intuitive for human to understand anymore. I would like to give an intuition that “the status of players to be both better or worse (than his normal self) is generally the same, e.g. high chance that both perfom worse due to the weather.</p> <h2 id="whats-next">What’s Next</h2> <p>Explanation of the usage in alignment tuning LLMs.</p> <hr> <h2 id="reference-and-footnote">Reference and Footnote</h2> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:1" role="doc-endnote"> <p>W. X. Zhao et al., “A Survey of Large Language Models.” arXiv, Sep. 11, 2023. Accessed: Oct. 24, 2023. [Online]. Available: http://arxiv.org/abs/2303.18223 <a href="#fnref:1" class="reversefootnote" role="doc-backlink">↩</a> <a href="#fnref:1:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p> </li> <li id="fn:2" role="doc-endnote"> <p>A. Glaese et al., “Improving alignment of dialogue agents via targeted human judgements.” arXiv, Sep. 28, 2022. doi: 10.48550/arXiv.2209.14375. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:3" role="doc-endnote"> <p><a href="https://leagueoflegends.fandom.com/wiki/Elo_rating_system" rel="external nofollow noopener" target="_blank">League of Lengends wiki: Elo Rating</a> <a href="#fnref:3" class="reversefootnote" role="doc-backlink">↩</a> <a href="#fnref:3:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a> <a href="#fnref:3:2" class="reversefootnote" role="doc-backlink">↩<sup>3</sup></a></p> </li> <li id="fn:6" role="doc-endnote"> <p><a href="https://www.cantorsparadise.com/the-mathematics-of-elo-ratings-b6bfc9ca1dba" rel="external nofollow noopener" target="_blank">The Mathematics of Elo Ratings: Calculating the relative skill of players in zero-sum games</a> <a href="#fnref:6" class="reversefootnote" role="doc-backlink">↩</a> <a href="#fnref:6:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a> <a href="#fnref:6:2" class="reversefootnote" role="doc-backlink">↩<sup>3</sup></a></p> </li> <li id="fn:7" role="doc-endnote"> <p><a href="https://www.kaggle.com/code/dancumming/math3311-group4" rel="external nofollow noopener" target="_blank">Kaggle MATH3311-Group4: Logistic Distribution on Elo Chess Data</a> <a href="#fnref:7" class="reversefootnote" role="doc-backlink">↩</a> <a href="#fnref:7:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p> </li> <li id="fn:4" role="doc-endnote"> <p>The logistic function is modeled as \(p(x) = \frac{1}{1 + e^{\frac{x-\mu}{s}}}\), where \(\mu\) and \(s\) controls the curve shifting and steep respectively (see <a href="https://en.wikipedia.org/wiki/Logistic_regression" rel="external nofollow noopener" target="_blank">wiki</a> for more). And correspondingly, logistic regression is actually classification model that tries to learn parameters (normally in the format of \(p(x) = \frac{1}{1+e^{\mathbf{w}^\intercal x}}\)) of the logistic function model to correctly (in probability) classify the input into two different categories. <a href="#fnref:4" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:5" role="doc-endnote"> <p><a href="https://en.wikipedia.org/wiki/Logit" rel="external nofollow noopener" target="_blank">https://en.wikipedia.org/wiki/Logit</a> <a href="#fnref:5" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:9" role="doc-endnote"> <p><a href="https://nicidob.github.io/nba_elo/" rel="external nofollow noopener" target="_blank">FiveThirtyEight’s Elo Ratings and Logistic Regression</a> <a href="#fnref:9" class="reversefootnote" role="doc-backlink">↩</a> <a href="#fnref:9:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p> </li> <li id="fn:10" role="doc-endnote"> <p><a href="https://en.wikipedia.org/wiki/Logistic_distribution" rel="external nofollow noopener" target="_blank">Wikipedia: Logistic distribution</a> <a href="#fnref:10" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:11" role="doc-endnote"> <p><a href="https://srabbani.com/bivariate.pdf" rel="external nofollow noopener" target="_blank">Proof that the Difference of Two Jointly Distributed Normal Random Variables is Normal</a> <a href="#fnref:11" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:12" role="doc-endnote"> <p><a href="https://stackoverflow.com/questions/2823468/how-do-i-add-variables-with-logistic-distributions#:~:text=The%20sum%20of%20two%20logistic%20random%20variables%20does%20not%20have,normal%20random%20variables%20is%20normal." rel="external nofollow noopener" target="_blank">stackoverflow: how do i add variables with logistic distributions?</a> <a href="#fnref:12" class="reversefootnote" role="doc-backlink">↩</a> <a href="#fnref:12:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p> </li> <li id="fn:13" role="doc-endnote"> <p><a href="https://mathoverflow.net/questions/157569/explicit-expressions-of-the-distribution-of-sums-of-i-i-d-logistic-random-varia" rel="external nofollow noopener" target="_blank">mathoverflow: explicit expressions of the distribution of sums of i.i.d. logistic random variables</a> <a href="#fnref:13" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:14" role="doc-endnote"> <p><a href="https://stats.stackexchange.com/questions/422243/what-are-the-elo-formulas-when-assuming-performance-to-be-logistically-distribut" rel="external nofollow noopener" target="_blank">stackexchange: What are the Elo formulas when assuming performance to be logistically distributed?</a> <a href="#fnref:14" class="reversefootnote" role="doc-backlink">↩</a></p> </li> </ol> </div> </div> </article> <div id="giscus_thread" style="max-width: 900px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"xf-zhao/xf-zhao.github.io","data-repo-id":"R_kgDOKJzBLw","data-category":"Comments","data-category-id":"DIC_kwDOKJzBL84CZeBf","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2023 Xufeng Zhao / 赵绪锋. Last updated: November 07, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="xufeng" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script> </html>